function gh = gradh(x)
h1 = 1000*sin(-x(3)-0.25) + 1000*sin(-x(4)-0.25) + 894.8 - x(1);
h2 = 1000*sin(x(3)-0.25) + 1000*sin(x(3)-x(4)-0.25) + 894.8 - x(2);
h3 = 1000*sin(x(4)-0.25) + 1000*sin(x(4)-x(3)-0.25) + 1294.8;
h = [h1;h2;h3];

n = length(x);
gh1 = [-1,0,-1000*cos(-x(3)-0.25),-1000*cos(-x(4)-0.25)];
gh2 = [0,-1,1000*cos(x(3)-0.25)+1000*cos(x(3)-x(4)-0.25),-1000*cos(x(3)-x(4)-0.25)];
gh3 = [0,0,-1000*cos(x(4)-x(3)-0.25),1000*cos(x(4)-0.25)+1000*cos(x(4)-x(3)-0.25)];
Dh = [gh1;gh2;gh3];
gh = Dh';